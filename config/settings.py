"""
アプリケーション設定
HTTPサーバ、TBBOX接続、その他の設定を一元管理します。
"""
import os
from pathlib import Path
from dotenv import load_dotenv

# .envファイルを読み込む
load_dotenv()


# ========================================
# HTTPサーバ設定
# ========================================

# HTTPサーバの待ち受けホスト
HTTP_HOST = os.getenv("HTTP_HOST", "0.0.0.0")

# HTTPサーバの待ち受けポート
# linkbaseがポート80を使用するため、8080を使用
HTTP_PORT = int(os.getenv("HTTP_PORT", "8080"))

# TBBOX接続をスキップするかどうか（テスト用）
# "true" または "1" でスキップ
TBBOX_SKIP_CONNECTION = os.getenv("TBBOX_SKIP_CONNECTION", "false").lower() in ("true", "1")


# ========================================
# TBBOX接続設定
# ========================================

# TBBOXデバイスのIPアドレス
TBBOX_IP = os.getenv("TBBOX_IP", "192.168.1.100")

# TBBOXのポート番号
TBBOX_PORT = int(os.getenv("TBBOX_PORT", "5503"))

# デバイスのシリアル番号
TBBOX_DEVICE_SN = os.getenv("TBBOX_DEVICE_SN", "")

# ログインユーザー名
TBBOX_USERNAME = os.getenv("TBBOX_USERNAME", "123456")

# ログインパスワード
TBBOX_PASSWORD = os.getenv("TBBOX_PASSWORD", "123456")

# ログインコマンド（16進数）
# 「T Card Login Protocol Calculation」ツールで生成したコマンドを設定
# LOGIN_COMMANDは.envで管理
LOGIN_COMMAND = os.getenv("TBBOX_LOGIN_COMMAND", "414141414141414141414141414141414141414141414141414141414141414141414141")  # ダミー値


# ========================================
# プログラム制御コマンド（16進数）
# ========================================

# プログラム切り替えコマンド（01-20）
# TB series central control protocol-V1.0.0.pdf より
PROGRAM_COMMANDS = {
    "01": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223031227d",  # プログラム01
    "02": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223032227d",  # プログラム02
    "03": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223033227d",  # プログラム03
    "04": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223034227d",  # プログラム04
    "05": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223035227d",  # プログラム05
    "06": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223036227d",  # プログラム06
    "07": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223037227d",  # プログラム07
    "08": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223038227d",  # プログラム08
    "09": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223039227d",  # プログラム09
    "10": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223130227d",  # プログラム10
    "11": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223131227d",  # プログラム11
    "12": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223132227d",  # プログラム12
    "13": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223133227d",  # プログラム13
    "14": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223134227d",  # プログラム14
    "15": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223135227d",  # プログラム15
    "16": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223136227d",  # プログラム16
    # LinkBaseではプログラム17-20には未対応
    # "17": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223137227d",  # プログラム17
    # "18": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223138227d",  # プログラム18
    # "19": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223139227d",  # プログラム19
    # "20": "41564f4e0200000051521e00090400000d000000000011027b226e616d65223a223230227d",  # プログラム20
}

# 再生制御コマンド
PAUSE_COMMAND = "41564f4e0200000051521e000c0400000000000000000702"   # 一時停止
RESUME_COMMAND = "41564f4e0200000051521e000a0400000000000000000502"  # 再生再開
STOP_COMMAND = "41564f4e0200000051521e000b0400000000000000000602"    # 停止

# 音量制御コマンド（0-100%、10刻み）
# TB series central control protocol-V1.0.0.pdf より
VOLUME_0_COMMAND = "41564f4ea507000051522600040000000b0000000000b8017b22726174696f223a307d"        # 音量0%
VOLUME_10_COMMAND = "41564f4eab07000051522600040000000c0000000000bf017b22726174696f223a31307d"      # 音量10%
VOLUME_20_COMMAND = "41564f4eb507000051522600040000000c0000000000c9017b22726174696f223a32307d"      # 音量20%
VOLUME_30_COMMAND = "41564f4ebc07000051522600040000000c0000000000d0017b22726174696f223a33307d"      # 音量30%
VOLUME_40_COMMAND = "41564f4ec207000051522600040000000c0000000000d6017b22726174696f223a34307d"      # 音量40%
VOLUME_50_COMMAND = "41564f4ec807000051522600040000000c0000000000dc017b22726174696f223a35307d"      # 音量50%
VOLUME_60_COMMAND = "41564f4ed007000051522600040000000c0000000000e4017b22726174696f223a36307d"      # 音量60%
VOLUME_70_COMMAND = "41564f4ed607000051522600040000000c0000000000ea017b22726174696f223a37307d"      # 音量70%
VOLUME_80_COMMAND = "41564f4edb07000051522600040000000c0000000000ef017b22726174696f223a38307d"      # 音量80%
VOLUME_90_COMMAND = "41564f4ee207000051522600040000000c0000000000f6017b22726174696f223a39307d"      # 音量90%
VOLUME_100_COMMAND = "41564f4ee807000051522600040000000d0000000000fd017b22726174696f223a3130307d"   # 音量100%


# ========================================
# 接続設定
# ========================================

# 接続リトライ回数
CONNECTION_MAX_RETRIES = 5

# 接続リトライ間隔（秒）
CONNECTION_RETRY_INTERVAL = 3

# コマンド送信リトライ回数
COMMAND_MAX_RETRIES = 3


# ========================================
# ログ設定
# ========================================

# ログレベル
# 選択肢: "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"
LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
